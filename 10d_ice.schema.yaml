# Rime schema
# encoding: utf-8


# æ–¹æ¡ˆè¯´æ˜
schema:
  schema_id: 10d_ice
  name: åæŒ‡å¹¶å‡»ãƒ»é›¾å‡‡æ‹¼éŸ³
  version: "2024-06-30"
  author:
    - Dvel
    - Etaoin
  description: |
    é›¾å‡‡æ‹¼éŸ³
    https://github.com/iDvel/rime-ice
  # dependencies:


# å¼€å…³
# reset: é»˜è®¤çŠ¶æ€ã€‚æ³¨é‡Šæ‰åï¼Œåˆ‡æ¢çª—å£æ—¶ä¸ä¼šé‡ç½®åˆ°é»˜è®¤çŠ¶æ€ã€‚
# states: æ–¹æ¡ˆé€‰å•æ˜¾ç¤ºçš„åç§°ã€‚å¯ä»¥æ³¨é‡Šæ‰ï¼Œä»å¯ä»¥é€šè¿‡å¿«æ·é”®åˆ‡æ¢ã€‚
# abbrev: é»˜è®¤çš„ç¼©å†™å– states çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œabbrev å¯è‡ªå®šä¹‰ä¸€ä¸ªå­—ç¬¦
switches:
  - name: ascii_mode
    states: [ ä¸­, ï¼¡ ]
  - name: ascii_punct  # ä¸­è‹±æ ‡ç‚¹
    states: [ Â¥, $ ]
  - name: traditionalization
    states: [ ç®€, ç¹ ]
  - name: emoji
    states: [ ğŸ’€, ğŸ˜„ ]
    reset: 1
  - name: full_shape
    states: [ åŠè§’, å…¨è§’ ]
  - name: aux_code_single_char
    states: [å…¨è¯, å•å­—]
    reset: 1
  - name: aux_code_nonmatch_policy
    reset: 0
    states: ["ç­›é€‰", "ä¼˜å…ˆ"]
  - options: [aux_code_hint_always, aux_code_hint_on_trigger, aux_code_hint_never]
    reset: 1
    states: ["è¾…ç æ˜¾ç¤º", "è¾…ç æŒ‰éœ€", "è¾…ç éšè—"]
    abbrev: ["æ˜¾", "éœ€", "éš"]



# è¾“å…¥å¼•æ“
engine:
  processors:
    - lua_processor@select_character          # ä»¥è¯å®šå­—
    - ascii_composer
    - recognizer
    - chord_composer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - lua_processor@*back_syllable_processor  # é€€æ ¼
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - script_translator
    - table_translator@custom_phrase    # è‡ªå®šä¹‰çŸ­è¯­ custom_phrase.txt
    - lua_translator@force_gc           # æš´åŠ› GC
  filters:
    - simplifier@traditionalize                     # ç®€ç¹åˆ‡æ¢
    - uniquifier                                    # å»é‡
    - lua_filter@*aux_code@ZRM_Aux-code_4.3         # è¾…ç 

chord_composer:
  alphabet: ' c,qwervmiop[tubn'
  algebra:
    # å…ˆå°‡ç‰©ç†æŒ‰éµå­—ç¬¦å°æ‡‰åˆ°10dpyéµä½ä¸­çš„æ‹¼éŸ³å­—æ¯
    - 'xlit| c,qwervmiop[tubn|#@!ZHGDYWAEUNFXá»´áºˆ|'

    # åŠŸèƒ½åŒº
    - xform/^(F|X|FX)$/*/
    - xform/^ZHGDYW$/å–æ¶ˆ/

    # é€‰å­—
    - xform/^#Z$/é€‰å­—1/
    - xform/^#H$/é€‰å­—2/
    - xform/^#G$/é€‰å­—3/
    - xform/^#D$/é€‰å­—4/
    - xform/^#A$/é€‰å­—6/
    - xform/^#E$/é€‰å­—7/
    - xform/^#U$/é€‰å­—8/
    - xform/^#N$/é€‰å­—9/
    - xform/^#Y$/é€‰å­—0/
    - xform/^#á»´$/é€‰å­—5/
    - xform/^á»´$/,/
    - xform/^áºˆ$/./


    # âŸ¨erâŸ©è‡ªæˆéŸ³ç¯€
    - xform/^ZGYWEN$/er/
    # å£°æ¯
    - xform/^ZHGD/b/
    - xform/^ZGD/p/
    - xform/^ZD/m/
    - xform/^ZHD/f/
    - xform/^D/d/
    - xform/^ZHG/t/
    - xform/^ZG/n/
    - xform/^HD/l/
    - xform/^ZH/r/
    - xform/^Z/zh/
    - xform/^HGD/ch/
    - xform/^GD/sh/
    - xform/^G/g/
    - xform/^HG/k/
    - xform/^H/h/
    # å£°æ¯ï¼šjqx ç»„
    - xform/^gY/jY/
    - xform/^kY/qY/
    - xform/^hY/xY/
    # å£°æ¯ï¼šå¹³èˆŒéŸ³
    - xform/^([zcs])hY/$1/

    # éŸµæ¯
    #   -ng: -UN
    - xform/AUN$/ang/
    - xform/AEUN$/ong/
    - xform/YUN$/ing/
    - xform/UN$/eng/
    #   -i: -EN
    - xform/AEN$/ai/
    - xform/EN$/ei/
    #   -n: -N
    - xform/AN$/an/
    - xform/YN$/in/
    - xform/YWN$/Ã¼n/
    - xform/N$/en/
    #   -o/-u: -U
    - xform/AU$/ao/
    - xform/EU$/ou/
    #   é›¶éŸµå°¾
    - xform/A$/a/
    - xform/AE$/o/
    - xform/E$/e/

    #   éŸµè…¹
    - xform/YW/Ã¼/
    - xform/Y/i/
    - xform/W/u/

    # æ‹¼å†™ï¼šé›¶å£°æ¯
    - xform/^i(ng?)$/yi$1/
    - xform/^i$/yi/
    - xform/^i/y/
    - xform/^u$/wu/
    - xform/^u/w/
    - xform/^Ã¼$/yÃ¼/
    - xform/^Ã¼/yÃ¼/

    # æ‹¼å†™ï¼š
    - xform/([wu])e$/$1o/
    - xform/uei$/ui/
    - xform/iou$/iu/
    - xform/uen$/un/
    - xform/^([jqxy])Ã¼/$1u/
    - xform/Ã¼/v/

    # é›¶éŸµæ¯é€Ÿç 
    - xform/^([bpf])$/$1u/
    - xform/^([mdtnlgkh])$/$1e/
    - xform/^([zcsr]h?)$/$1i/

    # è¾…ç 
    - xform/^([bpmfdtnlgkhzcsryw])U$/è¾…ç $1/
    - xform/^zhU$/è¾…ç v/
    - xform/^chU$/è¾…ç i/
    - xform/^shU$/è¾…ç u/
    - xform/^([jqx])iU$/è¾…ç $1/
    - xform/^yuU$/è¾…ç a/
    - xform/^xuU$/è¾…ç o/
    - xform/^nvU$/è¾…ç e/
  # ä¸¦æ“Šå®Œæˆå¾Œå¥—ç”¨çš„å¼æ¨£
  output_format:
    # è¿½åŠ éš”éŸ³ç¬¦è™Ÿ
    - "xform/^([bpm])([iu]|a|i?e|o|[ae]i|i?ao|[oi]u|i?an|[ie]n|[ei]ng|ang|ong)$/$1$2'/"
    - "xform/^([fw])(u|a|o|[ae]i|ao|ou|an|en|eng|ang|ong)$/$1$2'/"
    - "xform/^([dt])([iu]|i?a|i?e|uo|[aeu]i|i?ao|[oi]u|[iu]?an|[ue]n|[ei]ng|ang|ong)$/$1$2'/"
    - "xform/^([nl])([iuv]|i?a|[iv]?e|u?o|[aeu]i|i?ao|[oi]u|[iu]?an|[iue]n|[ei]ng|i?ang|ong)$/$1$2'/"
    - "xform/^([gkh])(u|u?a|e|uo|u?ai|[ue]i|ao|ou|u?an|[ue]n|eng|u?ang|ong)$/$1$2'/"
    - "xform/^([zcs]h?|r)([iu]|u?a|e|uo|u?ai|[ue]i|ao|ou|u?an|[ue]n|eng|u?ang|ong)$/$1$2'/"
    - "xform/^([jqxy])([iu]|i?a|[iu]?e|o|i?ao|[oi]u|[iu]?an|[iu]n|ing|i?ang|i?ong)$/$1$2'/"
    - "xform/^([aeo]|[ae]i|ao|ou|[ae]ng?|er)$/$1'/"
    # æ¶ˆé™¤ä¸æ§‹æˆåˆæ³•éŸ³ç¯€çš„ä¸¦æ“Šçµ„åˆ
    - "erase/^([A-Za-z]+)$/"
    - 'xform/^\*+$/{BackSpace}/'
    - 'xform/^#$/ /'
    - 'xform/^é€‰å­—([1-7])$/$1/'
    - 'xform/^è¾…ç ([a-z])$/;$1/'
    - 'xform/^å–æ¶ˆ$/{Escape}/'
    - 'erase/^.*[á»´áºˆ].*$/'
  # ä¸¦æ“Šéç¨‹ä¸­å¥—ç”¨çš„å¼æ¨£
  prompt_format:
    # åŠ æ–¹æ‹¬å¼§
    - 'xform/^(.*)$/[$1]/'

editor:
  bindings:
    BackSpace: back_syllable_delimited

# æ‹¼å†™è®¾å®š
speller:
  # å¦‚æœä¸æƒ³è®©ä»€ä¹ˆæ ‡ç‚¹ç›´æ¥ä¸Šå±ï¼Œå¯ä»¥åŠ åœ¨ alphabetï¼Œæˆ–è€…ç¼–è¾‘æ ‡ç‚¹ç¬¦å·ä¸ºä¸¤ä¸ªåŠä»¥ä¸Šçš„æ˜ å°„
  alphabet: "zyxwvutsrqponmlkjihgfedcba';"
  initials: zyxwvutsrqponmlkjihgfedcba
  delimiter: " "
  syllable_begin: ";"
  syllable_end: "'"
  algebra:
    ### v u è½¬æ¢
    # é›¾å‡‡çš„è¯åº“ä¸¥æ ¼æŒ‰ç…§æ­£ç¡®çš„ u v(Ã¼) æ³¨éŸ³çš„ï¼Œæ”¯æŒä½¿ç”¨ qu/qv nue/nve æ¥è¾“å…¥ qu nve
    - derive/^([nl])ve$/$1ue/
    - derive/^([jqxy])u/$1v/
    # ä»¥é˜²å¼•å…¥çš„å…¶ä»–è¯åº“æ²¡æŒ‰ç…§æ­£ç¡®æ–¹å¼æ³¨éŸ³ï¼Œä¹Ÿåšä¸€ä¸ªè½¬æ¢
    - derive/^([nl])ue$/$1ve/
    - derive/^([jqxy])v/$1u/
    # æ‹¼éŸ³éŸ³ç¯€ä¸€å¾‹å¾ŒåŠ éš”éŸ³ç¬¦è™Ÿï¼Œé¿å…éŸ³ç¯€åˆ‡åˆ†æ­§ç¾©
    - "xform/^([a-z]+)$/$1'/"


# ä¸»ç¿»è¯‘å™¨ï¼Œæ‹¼éŸ³
translator:
  dictionary: rime_ice        # æŒ‚è½½è¯åº“ rime_ice.dict.yaml
  prism: 10d_ice
  initial_quality: 1.2        # æ‹¼éŸ³çš„æƒé‡åº”è¯¥æ¯”è‹±æ–‡å¤§
  preedit_format:             # preedit_format å½±å“åˆ°è¾“å…¥æ¡†çš„æ˜¾ç¤ºå’Œâ€œShift+å›è½¦â€ä¸Šå±çš„å­—ç¬¦
    - xform/([jqxy])v/$1u/    # æ˜¾ç¤ºä¸º ju qu xu yu
    - xform/([nl])v/$1Ã¼/    # æ˜¾ç¤ºä¸º nÃ¼ lÃ¼
    - xform/([nl])ue/$1Ã¼e/  # æ˜¾ç¤ºä¸º nÃ¼e lÃ¼e
    # - xform/([nl])v/$1v/      # æ˜¾ç¤ºä¸º nv lv
    # - xform/([nl])ue/$1ve/    # æ˜¾ç¤ºä¸º nve lve
    - "xform/' / /"
    - "xform/'$//"


# è‡ªå®šä¹‰çŸ­è¯­ï¼šcustom_phrase.txt
custom_phrase:
  dictionary: ""
  user_dict: custom_phrase  # å¯ä»¥ä¿®æ”¹è¿™é‡Œï¼Œæ”¹æˆè‡ªå·±çš„ txt æ–‡ä»¶
  db_class: stabledb        # åªè¯»æ•°æ®åº“ï¼Œæ— æ³•åŠ¨æ€è°ƒé¢‘ï¼›è®¾ä¸º tabledb å¯ä»¥åŠ¨æ€è°ƒé¢‘
  enable_completion: false  # è¡¥å…¨æç¤º
  enable_sentence: false    # ç¦æ­¢é€ å¥
  initial_quality: 99       # custom_phrase çš„æƒé‡åº”è¯¥æ¯” pinyin å’Œ melt_eng å¤§


# ç®€ç¹åˆ‡æ¢
traditionalize:
  option_name: traditionalization
  opencc_config: s2t.json  # s2t.json | s2hk.json | s2tw.json | s2twp.json
  tips: none               # è½¬æ¢æç¤º: all éƒ½æ˜¾ç¤º | char ä»…å•å­—æ˜¾ç¤º | none ä¸æ˜¾ç¤ºã€‚
  tags: [ abc, number, gregorian_to_lunar ]  # é™åˆ¶åœ¨å¯¹åº” tagï¼Œä¸å¯¹å…¶ä»–å¦‚åæŸ¥çš„å†…å®¹åšç®€ç¹è½¬æ¢


# æ ‡ç‚¹ç¬¦å·
# punctuator ä¸‹é¢æœ‰ä¸‰ä¸ªå­é¡¹ï¼š
#   full_shape å…¨è§’æ ‡ç‚¹æ˜ å°„
#   half_shape åŠè§’æ ‡ç‚¹æ˜ å°„
#   symbols    Rime çš„é¢„è®¾é…ç½®æ˜¯ä»¥ '/' å‰ç¼€å¼€å¤´è¾“å‡ºä¸€ç³»åˆ—å­—ç¬¦ï¼Œè‡ªå®šä¹‰çš„ symbols_v.yaml ä¿®æ”¹æˆäº† 'v' å¼€å¤´ã€‚
punctuator:
  full_shape:
    __include: default:/punctuator/full_shape  # ä» default.yaml å¯¼å…¥é…ç½®
  half_shape:
    __include: default:/punctuator/half_shape  # ä» default.yaml å¯¼å…¥é…ç½®
  symbols:
    __include: symbols_v:/symbols              # ä» symbols_v.yaml å¯¼å…¥é…ç½®


# å¤„ç†ç¬¦åˆç‰¹å®šè§„åˆ™çš„è¾“å…¥ç ï¼Œå¦‚ç½‘å€ã€åæŸ¥
recognizer:
  import_preset: default  # ä» default.yaml ç»§æ‰¿é€šç”¨çš„
  patterns:  # å†å¢åŠ æ–¹æ¡ˆä¸“æœ‰çš„ï¼š
    punct: "^v([0-9]|10|[A-Za-z]+)$"    # å“åº” symbols_v.yaml çš„ symbolsï¼Œç”¨ 'v' æ›¿æ¢ '/'


# ä» default ç»§æ‰¿å¿«æ·é”®
key_binder:
  import_preset: default
  bindings:
    - {accept: Tab, send_sequence: "{End};", when: composing}


aux_code:
  # ignore_prefixes: # å¯¹åº” /recognizer/patterns
  #   - "V" # symbols
  #   - "uU" # éƒ¨ä»¶æ‹†å­—
  #   - "U" # Unicode
  #   - "R" # æ•°å­—é‡‘é¢
  #   - "N" # å†œå†
  ignore_regex: "^(V|uU|U|R|N)"
  show_auxcode_hint: option
  nonmatch_policy: option
  filter_mode: option

